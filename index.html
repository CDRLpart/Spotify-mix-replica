<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Spotify Mix – Replica</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header class="app-header">
    <h1>Mix-Übergänge wie bei Spotify</h1>
    <p>Lade zwei Songs und deren Analyse-JSON hoch. Plane automatische, beat-ausgerichtete Übergänge mit Equal-Power‑Crossfade, optionalem EQ und exportiere das Ergebnis.</p>
  </header>

  <main class="app-main">
    <section class="inputs">
      <div class="track-card">
        <h2>Track A</h2>
        <label class="file-label">Audio-Datei
          <input id="audioA" type="file" accept="audio/*" />
        </label>
        <label class="file-label">Analyse-JSON
          <input id="jsonA" type="file" accept="application/json,.json" />
        </label>
        <div class="meta" id="metaA"></div>
        <canvas id="waveA" class="wave"></canvas>
      </div>

      <div class="track-card">
        <h2>Track B</h2>
        <label class="file-label">Audio-Datei
          <input id="audioB" type="file" accept="audio/*" />
        </label>
        <label class="file-label">Analyse-JSON
          <input id="jsonB" type="file" accept="application/json,.json" />
        </label>
        <div class="meta" id="metaB"></div>
        <canvas id="waveB" class="wave"></canvas>
      </div>
    </section>

    <section class="planner">
      <h2>Übergang planen</h2>
      <div class="controls-grid">
        <label>Preset-Kurve
          <select id="curvePreset">
            <option value="dj-s" selected>DJ S‑Kurve (empf.)</option>
            <option value="equal-power">Equal-Power</option>
            <option value="linear">Linear</option>
            <option value="rise">Rise (sanfter Start, schnelleres Ausblenden)</option>
          </select>
        </label>

        <label>Übergangslänge (Beats)
          <input id="beatsLength" type="number" min="4" max="64" step="1" value="16" />
        </label>

        <label>Tempo-Anpassung
          <select id="tempoStrategy">
            <option value="matchBtoA" selected>B an A anpassen</option>
            <option value="matchAtoB">A an B anpassen</option>
            <option value="average">Beide auf Mittelwert</option>
          </select>
        </label>

        <div class="eq-row">
          <label><input id="eqEnable" type="checkbox" checked /> Sanfte EQ-Hilfe im Übergang</label>
          <div class="eq-params">
            <label>Tiefen A ducken (dB)
              <input id="eqLowDuckDb" type="number" step="1" value="-3" />
            </label>
            <label>Höhen B boosten (dB)
              <input id="eqHighBoostDb" type="number" step="1" value="2" />
            </label>
          </div>
        </div>

        <fieldset style="grid-column: 1 / -1; border: 1px solid #2b2f36; padding: 8px; border-radius: 6px;">
          <legend>Smart DJ</legend>
          <div class="controls-grid" style="grid-template-columns: repeat(6, minmax(0, 1fr)); gap: 8px;">
            <label><input id="smartLength" type="checkbox" checked /> Smarte Länge</label>
            <label><input id="phraseAlign" type="checkbox" checked /> Phrasen‑Ausrichtung</label>
            <label><input id="harmonicMatch" type="checkbox" checked /> Harmonisch matchen</label>
            <label><input id="tempoRamp" type="checkbox" checked /> Tempo‑Ramp</label>
            <label><input id="filterSwap" type="checkbox" checked /> Filter‑Swap</label>
            <label><input id="pitchLock" type="checkbox" checked /> Pitch‑Lock (Tonhöhe beibehalten)</label>
            <label>Max. Detune (Halbtöne)
              <input id="maxDetuneSemis" type="number" step="1" min="0" max="6" value="2" />
            </label>
            <label>Min Beats
              <input id="minBeats" type="number" step="1" min="4" max="256" value="16" />
            </label>
            <label>Max Beats
              <input id="maxBeats" type="number" step="1" min="8" max="512" value="64" />
            </label>
          </div>
        </fieldset>

        <button id="autoPlan" class="primary">Auto-Übergang finden</button>
      </div>

      <div id="planInfo" class="plan-info"></div>
    </section>

    <section class="transport">
      <h2>Vorschau & Export</h2>
      <div class="transport-row">
        <button id="previewPlay" class="primary" disabled>Vorschau abspielen</button>
        <button id="previewStop" disabled>Stopp</button>
        <button id="renderExport" disabled>Rendern & Download (WAV)</button>
        <span id="status"></span>
      </div>
    </section>
  </main>

  <footer class="app-footer">
    <small>Hinweis: Dies ist eine Nachbildung zu Demonstrationszwecken und nutzt lokale Dateien statt der Spotify API. Beispiel-Analyse: <code>mockingbird.json</code>.</small>
  </footer>

  <script src="script.js"></script>
  </body>
</html>


